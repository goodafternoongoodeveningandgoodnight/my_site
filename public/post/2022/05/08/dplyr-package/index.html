<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Tidyverse Dplyr Package | A minimal personal website</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>
      <link rel="shortcut icon" type="image/png" href="/img/favicon.ico">
      <link rel="shortcut icon" sizes="192x192" href="/img/favicon.ico">
      <link rel="apple-touch-icon" href="/img/favicon.ico">
  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/blogs">Blogs</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Tidyverse Dplyr Package</span></h1>
<h2 class="author">Sikai Huang</h2>
<h2 class="date">2022/05/08</h2>
</div>

<main>



<div id="introduction-to-dplyr" class="section level1">
<h1>Introduction to dplyr</h1>
<div id="essential-package" class="section level2">
<h2>Essential package</h2>
<pre class="r"><code>library(dplyr)
library(gapminder) # a built-in dataset called &quot;gapminder&quot; in R studio</code></pre>
</div>
<div id="filter" class="section level2">
<h2>Filter</h2>
<p>Extracting a subset from observations, only containing the row of chosen variables.</p>
<pre class="r"><code>gapminder %&gt;%
  filter(year == 2002, country == &quot;China&quot;) 
## # A tibble: 1 × 6
##   country continent  year lifeExp        pop gdpPercap
##   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;      &lt;int&gt;     &lt;dbl&gt;
## 1 China   Asia       2002    72.0 1280400000     3119.</code></pre>
</div>
<div id="arrange" class="section level2">
<h2>Arrange</h2>
<p>Sortng observations in ascending or descending order of a particular variable.</p>
<pre class="r"><code># Sort in descending order of lifeExp
gapminder %&gt;%
  arrange(desc(lifeExp))  # the example of ascending order is the default setup not shown here</code></pre>
<pre><code>## # A tibble: 1,704 × 6
##    country          continent  year lifeExp       pop gdpPercap
##    &lt;fct&gt;            &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
##  1 Japan            Asia       2007    82.6 127467972    31656.
##  2 Hong Kong, China Asia       2007    82.2   6980412    39725.
##  3 Japan            Asia       2002    82   127065841    28605.
##  4 Iceland          Europe     2007    81.8    301931    36181.
##  5 Switzerland      Europe     2007    81.7   7554661    37506.
##  6 Hong Kong, China Asia       2002    81.5   6762476    30209.
##  7 Australia        Oceania    2007    81.2  20434176    34435.
##  8 Spain            Europe     2007    80.9  40448191    28821.
##  9 Sweden           Europe     2007    80.9   9031088    33860.
## 10 Israel           Asia       2007    80.7   6426679    25523.
## # … with 1,694 more rows</code></pre>
</div>
<div id="mutate" class="section level2">
<h2>Mutate</h2>
<p>Using mutate to change(overwrite an existing one) or create a column</p>
<pre class="r"><code># Use mutate to change the lifeExp
gapminder %&gt;%
  mutate(lifeExp = lifeExp * 12)
# Use mutate to create a new column called lifeExpMonths
gapminder %&gt;%
  mutate(lifeExpMonths = lifeExp * 12)</code></pre>
</div>
<div id="filter_arrange_mutate" class="section level2">
<h2>Filter_Arrange_Mutate</h2>
<pre class="r"><code># Filter, mutate, and arrange the gapminder dataset
gapminder %&gt;%
  filter(country == &quot;Japan&quot;) %&gt;%
  mutate(lifeExpMonths = lifeExp * 12) %&gt;%
  arrange(desc(lifeExpMonths))</code></pre>
<pre><code>## # A tibble: 12 × 7
##    country continent  year lifeExp       pop gdpPercap lifeExpMonths
##    &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;         &lt;dbl&gt;
##  1 Japan   Asia       2007    82.6 127467972    31656.          991.
##  2 Japan   Asia       2002    82   127065841    28605.          984 
##  3 Japan   Asia       1997    80.7 125956499    28817.          968.
##  4 Japan   Asia       1992    79.4 124329269    26825.          952.
##  5 Japan   Asia       1987    78.7 122091325    22376.          944.
##  6 Japan   Asia       1982    77.1 118454974    19384.          925.
##  7 Japan   Asia       1977    75.4 113872473    16610.          905.
##  8 Japan   Asia       1972    73.4 107188273    14779.          881.
##  9 Japan   Asia       1967    71.4 100825279     9848.          857.
## 10 Japan   Asia       1962    68.7  95831757     6577.          825.
## 11 Japan   Asia       1957    65.5  91563009     4318.          786 
## 12 Japan   Asia       1952    63.0  86459025     3217.          756.</code></pre>
</div>
</div>
<div id="grouping-and-summarising" class="section level1">
<h1>Grouping and Summarising</h1>
<pre class="r"><code>library(dplyr)
library(gapminder)</code></pre>
<div id="summarising" class="section level2">
<h2>Summarising</h2>
<pre class="r"><code>gapminder %&gt;%
  filter(year == 2007) %&gt;%
  summarize(medianLifeExp = median(lifeExp, na.rm = TRUE),
            maxGdpPercap = max(gdpPercap, na.rm = TRUE))</code></pre>
<pre><code>## # A tibble: 1 × 2
##   medianLifeExp maxGdpPercap
##           &lt;dbl&gt;        &lt;dbl&gt;
## 1          71.9       49357.</code></pre>
</div>
<div id="grouping" class="section level2">
<h2>Grouping</h2>
<pre class="r"><code>gapminder %&gt;%
  filter(year == 2007) %&gt;%
  group_by(continent) %&gt;%
  summarize(meanLifeExp = mean(lifeExp),
            totalPop = sum(pop)) # yield a value to each continent in a total of 5</code></pre>
<pre><code>## # A tibble: 5 × 3
##   continent meanLifeExp   totalPop
##   &lt;fct&gt;           &lt;dbl&gt;      &lt;dbl&gt;
## 1 Africa           54.8  929539692
## 2 Americas         73.6  898871184
## 3 Asia             70.7 3811953827
## 4 Europe           77.6  586098529
## 5 Oceania          80.7   24549947</code></pre>
</div>
<div id="visualizing-median-life-expectancy-over-time" class="section level2">
<h2>Visualizing median life expectancy over time</h2>
<pre class="r"><code>gapminder_year &lt;- gapminder %&gt;%
  group_by(year) %&gt;%
  summarize(medianLifeExp = median(lifeExp),
            maxGdpPercap = max(gdpPercap))
gapminder_year</code></pre>
<pre><code>## # A tibble: 12 × 3
##     year medianLifeExp maxGdpPercap
##    &lt;int&gt;         &lt;dbl&gt;        &lt;dbl&gt;
##  1  1952          45.1      108382.
##  2  1957          48.4      113523.
##  3  1962          50.9       95458.
##  4  1967          53.8       80895.
##  5  1972          56.5      109348.
##  6  1977          59.7       59265.
##  7  1982          62.4       33693.
##  8  1987          65.8       31541.
##  9  1992          67.7       34933.
## 10  1997          69.4       41283.
## 11  2002          70.8       44684.
## 12  2007          71.9       49357.</code></pre>
<pre class="r"><code># Create a scatter plot showing the change in medianLifeExp over time
library(ggplot2)
ggplot(gapminder_year, aes(x = year, y = medianLifeExp)) + 
  geom_point() +
  expand_limits(y = 0) # To make sure the plot&#39;s y-axis includes zero</code></pre>
<p><img src="/post/2022/05/08/dplyr-package/index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>
<div id="data-visualisation-using-ggplot" class="section level1">
<h1>Data visualisation using ggplot</h1>
<div id="essential-package-1" class="section level2">
<h2>Essential package</h2>
<pre class="r"><code>library(dplyr)
library(gapminder)
library(ggplot2)</code></pre>
</div>
<div id="scatter-plot" class="section level2">
<h2>Scatter plot</h2>
<pre class="r"><code># Create gapminder_1952
gapminder_1952 &lt;- gapminder %&gt;%
  filter(year == 1952)
# Create a scatter plot with pop on the x-axis and lifeExp on the y-axis
ggplot(gapminder_1952, aes(x = pop, y = lifeExp)) +
  geom_point()</code></pre>
<p><img src="/post/2022/05/08/dplyr-package/index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Some countries have <strong>much more</strong> population than others where we need to scale the data using <strong>scale_x_log10()</strong>.</p>
<pre class="r"><code>gapminder_1952 &lt;- gapminder %&gt;%
  filter(year == 1952)
ggplot(gapminder_1952, aes(x = pop, y = lifeExp)) +
  geom_point() +
  scale_x_log10()</code></pre>
<p><img src="/post/2022/05/08/dplyr-package/index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div id="size-and-color-in-plots" class="section level3">
<h3>Size and Color in plots</h3>
<pre class="r"><code>ggplot(gapminder_1952, aes(x = gdpPercap, y = lifeExp, color = continent, size = pop)) + 
  geom_point() + 
  scale_x_log10()</code></pre>
<p><img src="/post/2022/05/08/dplyr-package/index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="faceting" class="section level3">
<h3>Faceting</h3>
<p>To give a graph to each categorical variable, divide data into subplots</p>
<pre class="r"><code>ggplot(gapminder, aes(x = gdpPercap, y = lifeExp, color = continent, size = pop))+
  geom_point() +
  scale_x_log10() +
  facet_wrap(~ year) # &quot;~ year&quot; means by year</code></pre>
<p><img src="/post/2022/05/08/dplyr-package/index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
</div>

</main>

  <footer>
  <script defer src="//yihui.org/js/math-code.js"></script>
<script defer src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script defer src="//yihui.org/js/center-img.js"></script>

  
  <hr/>
  © <a href="https://huangsikai.org">Sikai Huang</a> 2022 &ndash; 2022 |<a href="https://www.linkedin.com/in/sikai-huang-59864a233/">Linkdin</a> |<a href="https://github.com/goodafternoongoodeveningandgoodnight">Github</a> | <a href="https://weibo.com/u/3211883205">Weibo</a>
  
  </footer>
  </body>
</html>

